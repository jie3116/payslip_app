<!-- slip.html -->

<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Slip Gaji</title>
  <style>
    .no-print { display: block; }
    {% if is_pdf %}
    .no-print { display: none !important; }
    {% endif %}
  </style>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/sidebar.css') }}">
  {% if css_path %}
    <link rel="stylesheet" href="{{ css_path }}">
  {% else %}
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
  {% endif %}
</head>

<body class="flex min-h-screen">
<div class="container">
  <!-- Sidebar -->
    <div class="sidebar flex flex-col justify-between no-print">
        <!-- Grup Navigasi Atas -->
        <div class="space-y-4">
            <h2 class="text-3xl font-bold mb-4">Slip Gaji</h2>

            <!-- Form Ubah Password -->
            <form action="{{ url_for('ubah_password') }}">
                <button type="submit" class="sidebar-nav-link">
                    Ubah Password
                </button>
            </form>

            <!-- Form Pilih Bulan -->
            <form method="POST" action="{{ url_for('select_month') }}" class="month-form" id="monthForm">
                <select name="file" class="select-box" id="monthSelect" onchange="this.form.submit()">
                    {% for bulan_data in available_months %}
                        <option value="{{ bulan_data.source_file }}"
                            {% if bulan_data.source_file == selected_month %}selected{% endif %}>
                            {{ bulan_data.BULAN }}/{{ bulan_data.TAHUN }}
                        </option>
                    {% endfor %}
                </select>
            </form>

            <!-- Form Download PDF -->
            <form action="{{ url_for('download') }}" method="get">
                <button type="submit" class="sidebar-nav-link">
                    Download PDF
                </button>
            </form>
        </div>

        <!-- Tombol Logout di Bawah -->
        <div>
            <a href="{{ url_for('logout') }}" class="sidebar-nav-link">
                Logout
            </a>
        </div>
    </div>

  <!-- Main Content -->
  <div class="main-content">
    <div style="max-width: 800px; margin: 0 auto; padding: 10px;">
      <!-- Header -->
      <table style="width: 100%;">
        <tr>
          <td style="width: 80px;">
            <img src="{{ logo_path or url_for('static', filename='logobki.png') }}" alt="Logo" style="width: 80px;">
          </td>
          <td style="text-align: center; font-weight: bold; font-size: 20px;">
            PT BIRO KLASIFIKASI INDONESIA (PERSERO)
          </td>
          <td style="width: 120px; text-align: right;">
            <div style="font-weight: bold; font-size: 16px;">SLIP GAJI</div>
            <div style="font-size: 14px;">{{ BULAN }} {{ TAHUN }}</div>
          </td>
        </tr>
      </table>

<!-- Info Pegawai -->
<table style="width: 100%; margin-top: 15px;">
  <!-- Baris 1: NUP/Nama & Grade (opsional) -->
  <tr>
    {%if status == 'pkwtt' or status == 'pkwt' %}
    <td style="width: 15%;">NUP / Nama</td>
    <td style="width: 1%;">:</td>
    <td style="width: 34%;">{{ NUP }} / {{ NAMA }}</td>
    {% else %}
    <td style="width: 15%;">Nama</td>
    <td style="width: 1%;">:</td>
    <td style="width: 34%;">{{ NAMA }}</td>
    {% endif %}

    {% if status == 'pkwtt' %}
      <td style="width: 15%;">Grade</td>
      <td style="width: 1%;">:</td>
      <td style="width: 28%;">{{ GRADE }}</td>
    {% else %}
      <td style="width: 15%;"></td>
      <td style="width: 1%;"></td>
      <td style="width: 28%;"></td>
    {% endif %}
  </tr>

  <!-- Baris 2: Jabatan & Unit Kerja -->
  <tr>
    <td>Jabatan</td>
    <td>:</td>
    <td>{{ JABATAN }}</td>
    {% if status == 'pkwtt' or status == 'pkwt' %}
    <td>Unit Kerja</td>
    <td>:</td>
    <td>{{ UNIT_KERJA }}</td>
    {% else %}
    <td></td>
    <td></td>
    <td></td>
    {% endif %}
  </tr>
</table>

      <hr style="border: 1.5px solid black; margin-top: 15px;">

<!-- Rincian Penghasilan -->
<table style="width: 100%;">
  <tr>
    <!-- Kiri: THP + Penghasilan Lain -->
    <td style="width: 47%; vertical-align: top;">
      <table class="gaji-table">
        <tr><td colspan="3" class="section-title">T H P</td></tr>
        {% for label, value in komponen_thp.items() %}
          <tr>
            <td class="label">{{ label }}</td>
            <td class="rp">Rp.</td>
            <td class="value">{{ value | rupiah }}</td>
          </tr>
        {% endfor %}
        <tr class="total-row">
          <td class="label">Total THP</td>
          <td class="rp">Rp.</td>
          <td class="value">{{ total_thp | rupiah }}</td>
        </tr>

        <tr><td colspan="3" class="section-title">PENGHASILAN LAIN</td></tr>
        {% for label, value in komponen_lain.items() %}
          <tr>
            <td class="label">{{ label }}</td>
            <td class="rp">Rp.</td>
            <td class="value">{{ value | rupiah }}</td>
          </tr>
        {% endfor %}
        <tr class="total-row">
          <td class="label">Total Penghasilan Lain</td>
          <td class="rp">Rp.</td>
          <td class="value">{{ total_lain | rupiah }}</td>
        </tr>
      </table>
    </td>

    <td style="width: 6%;"></td>

    <!-- Kanan: Potongan -->
    <td style="width: 47%; vertical-align: top;">
      <table class="gaji-table">
        <tr><td colspan="3" class="section-title">POTONGAN</td></tr>
        {% for label, value in komponen_potongan.items() %}
          <tr>
            <td class="label">{{ label }}</td>
            <td class="rp">Rp.</td>
            <td class="value">{{ value | rupiah }}</td>
          </tr>
        {% endfor %}

      </table>
    </td>
  </tr>
</table>

      <!-- Total -->
      <table class="gaji-table total-section" style="margin-top: 20px;">
        <tr>
          <td class="label">Total Gross</td>
          <td class="rp">Rp.</td>
          <td class="value">{{ THP_GROSS_II | rupiah }}</td>
          <td style="width: 34px;"></td>
          <td class="label">Total Potongan</td>
          <td class="rp">Rp.</td>
          <td class="value">{{ JML_POTONGAN | rupiah }}</td>
        </tr>
        <tr class="net-row">
          <td></td>
          <td></td>
          <td></td>
          <td style="width: 34px;"></td>
          <td class="label">Total Net</td>
          <td class="rp">Rp.</td>
          <td class="value">{{ THP_NET | rupiah }}</td>
        </tr>
      </table>

      <!-- Tanda Tangan -->
   <table style="width: 100%; margin-top: 20px;">
        <tr>
          <td style="width: 50%; text-align: left;">
            <p>{{ TEMPAT }}, {{ TANGGAL }} {{ BULAN }} {{ TAHUN }}</p>
            <p style="font-weight: bold;">Mengetahui,</p>
            <p>{{ JABATAN_PENANDATANGAN }}</p>
            {% if barcode_uri %}
              <img src="{{ barcode_uri }}" alt="Barcode Verifikasi Dokumen" style="height: 80px; margin-top: 10px;">
            {% else %}
              <img src="{{ signature_path or url_for('static', filename='tandatangan.png') }}" alt="Tanda Tangan" style="height: 80px;">
            {% endif %}
            <p style="font-weight: bold;">{{ PENANDATANGAN }}</p>
            <p style="font-size: 10px; font-style: italic;">Dokumen ini telah diverifikasi secara digital.</p>
          </td>
          <td style="width: 50%; text-align: right;">
            <p style="margin-bottom: 43px;">&nbsp;</p>
            <p>Diterima Oleh:</p>
            <p style="margin-bottom: 80px;">&nbsp;</p>
            <p style="font-weight: bold;">{{ NAMA }}</p>
          </td>
        </tr>
      </table>
    </div>
  </div>
</div>
</body>
</html>
